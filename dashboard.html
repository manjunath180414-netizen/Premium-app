<!DOCTYPE html>
<html>
<head>
  <title>HiS Academy Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Firebase Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body{
      margin:0;
      font-family:Poppins, sans-serif;
      background:linear-gradient(135deg,#0f0f1a,#1a1a2e);
      color:white;
    }

    .container{
      padding:20px;
      max-width:1000px;
      margin:auto;
    }

    .banner{
      background:linear-gradient(90deg,#FFD700,#ffcc00);
      color:black;
      padding:15px;
      border-radius:15px;
      font-weight:bold;
      text-align:center;
      margin-bottom:20px;
    }

    .card{
      background:#111827;
      padding:20px;
      border-radius:18px;
      margin-bottom:20px;
      box-shadow:0 0 25px rgba(255,215,0,0.15);
    }

    .highlight{ color:#FFD700; }

    .countdown{
      margin-top:10px;
      color:#ffcc00;
      font-weight:bold;
    }

    .batch-container{
      display:flex;
      overflow-x:auto;
      gap:15px;
      padding-bottom:10px;
    }

    .batch-card{
      min-width:220px;
      background:#1f2937;
      border-radius:15px;
      padding:15px;
      cursor:pointer;
      position:relative;
      text-align:center;
      transition:0.3s;
    }

    .batch-card img{
      width:100%;
      border-radius:10px;
      margin-bottom:10px;
    }

    .locked::after{
      content:"ðŸ”’ Locked";
      position:absolute;
      top:10px;
      right:10px;
      background:#000000aa;
      padding:5px 8px;
      border-radius:10px;
      font-size:12px;
    }

    @keyframes shake{
      0%{transform:translateX(0);}
      25%{transform:translateX(-5px);}
      50%{transform:translateX(5px);}
      75%{transform:translateX(-5px);}
      100%{transform:translateX(0);}
    }

    .shake{
      animation:shake 0.3s;
    }

    .button{
      width:100%;
      padding:14px;
      border-radius:12px;
      border:none;
      font-weight:bold;
      cursor:pointer;
      margin-top:10px;
    }

    .live-btn{background:#FFD700;color:black;}
    .record-btn{background:#1f2937;color:white;border:1px solid #FFD700;}
    .call-btn{background:#25D366;color:white;}

  </style>
</head>
<body>

<div class="container">

  <h2>Hi, <span id="studentName">Student</span> ðŸ‘‹</h2>

  <div class="banner">
    ðŸš€ Mega Scholarship Test Coming Soon | Stay Prepared!
  </div>

  <div class="card">
    <p>Total Hours Finished: <span class="highlight" id="totalHours">0</span> Hours</p>
    <div class="countdown" id="countdown"></div>
  </div>

  <!-- Batches -->
  <div class="card">
    <h3>Batches</h3>

    <div class="batch-container">

      <!-- Unlocked -->
      <div class="batch-card" onclick="openCourse()">
        <img src="sslc.jpg">
        <b class="highlight">SSLC 2026 Crash Course</b>
        <p>Study Now</p>
      </div>

      <!-- Locked -->
      <div class="batch-card locked" onclick="locked(this)">
        <img src="batch2.jpg">
        NEET 2026
      </div>

      <div class="batch-card locked" onclick="locked(this)">
        <img src="batch3.jpg">
        KCET Mastery
      </div>

      <div class="batch-card locked" onclick="locked(this)">
        <img src="batch4.jpg">
        Exam Booster
      </div>

    </div>
  </div>

  <button class="button live-btn" onclick="playLive()">
    â–¶ Watch Live Classes
  </button>

  <div id="liveVideo"></div>

  <button class="button record-btn" onclick="openRecorded()">
    ðŸŽ¥ Watch Recorded Classes
  </button>

  <button class="button call-btn" onclick="callNow()">
    ðŸ“ž Speak with Manjunath Sir
  </button>

</div>

<script>

  // ðŸ”¥ Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyCehyZQukDfslKTY_u9yXcUrzGtMNHvuPA",
    authDomain: "his-academy.firebaseapp.com",
    projectId: "his-academy",
    storageBucket: "his-academy.firebasestorage.app",
    messagingSenderId: "573278549264",
    appId: "1:573278549264:web:ca2ff160b5a100cc7d2195",
    measurementId: "G-8WPMS7H33F"
  };

  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  const db = firebase.firestore();

  // ðŸ”¥ Protect Dashboard
  auth.onAuthStateChanged((user) => {
console.log("Auth user:", user);

    if (user) {

      db.collection("students").doc(user.uid).get()
      .then((doc) => {

        if (!doc.exists) {
          window.location.href = "login.html";
        }

        const data = doc.data();
console.log("Logged in UID:", user.uid);
console.log("Firestore Data:", data);
console.log("Payment Status:", data.paymentStatus);

        if (data.paymentStatus !== "paid") {
          alert("Please complete enrollment first.");
          window.location.href = "courses.html";
        }

        document.getElementById("studentName").innerText = data.name;
        document.getElementById("totalHours").innerText = data.totalStudyHours;

      });

    } else {
      window.location.href = "login.html";
    }

  });

  // Countdown
  const examDate = new Date("March 18, 2026 10:00:00").getTime();
  setInterval(function(){
    const now = new Date().getTime();
    const distance = examDate - now;

    const days = Math.floor(distance / (1000*60*60*24));
    const hours = Math.floor((distance%(1000*60*60*24))/(1000*60*60));
    const minutes = Math.floor((distance%(1000*60*60))/(1000*60));
    const seconds = Math.floor((distance%(1000*60))/1000);

    document.getElementById("countdown").innerHTML =
      "â³ "+days+"d "+hours+"h "+minutes+"m "+seconds+"s left for SSLC Exam!";
  },1000);

  function locked(el){
    el.classList.add("shake");
    setTimeout(()=>el.classList.remove("shake"),300);
  }

  function openCourse(){
    window.location.href="recorded.html";
  }

  function openRecorded(){
    window.location.href="recorded.html";
  }

  function playLive(){
    document.getElementById("liveVideo").innerHTML =
      '<video controls width="100%"><source src="live.mp4" type="video/mp4"></video><p>Live: Maths Strategy Session</p>';
  }

  function callNow(){
    window.location.href="tel:02269719375";
  }

</script>

</body>
</html>
